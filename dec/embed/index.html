<html>
<head>
<style>
* {
	box-sizing: border-box;
}
body {
	font-family: "Helvetica Neue",Helvetica,arial,sans-serif;
	margin: 0;
}
.wrap {
	width: 500px;
	max-width: 100%;
	cursor: pointer;
	display: none;
	margin: 0 auto;
}
.container, .media_container {
	position: relative;
	border: 1px solid rgb(235, 238, 242);
}
.media_container {
	display: none;
}
.wrap:hover .container, .wrap:hover .media_container {
	border-color: rgb(194, 201, 212);;
}
.media_container {
	border-radius: 5px 5px 0 0;
}
.media_container img {
	border-radius: 4px 4px 0 0;
}
.container {
	padding: 10px;
	border-radius: 5px;
	margin-right: 1px;
}
.logo img {
	width: 25px;
	height: 24px;
}
.logo {
	position: absolute;
	top: 10px;
	right: 10px;
}
#avatar_link {
	text-decoration: none;
	color: inherit;
}
#avatar_link:hover .name {
	color: rgb(46, 159, 255);
}
.avatar {
	float: left;
	margin-right: 5px;
	margin-bottom: 10px;
}
.avatar img {
	width: 48px;
	height: 48px;
	border-radius: 24px;
	border: 1px solid rgb(235, 238, 242);
}
.name {
	font-weight: 700;
	display: inline-block;
}
.username:before {
	content: '@';
}
.username {
	display: inline-block;
	font-size: 14px;
	color: rgb(84, 102, 115);
}
.post {
	clear: both;
}
.post a {
	color: rgb(46, 135, 231);
}
.post a:hover {
	color: rgb(46, 159, 255);
}
.post p {
	margin: 5px 0px;
}
.date {
	font-size: 13px;
	color: rgb(84, 102, 115);
	margin-bottom: 5px;
}
.likes {
	font-size: 14px;
	color: rgb(84, 102, 115);
}
.likes:before {
	content: '\2303';
	font-size: 20px;
	font-weight: bold;
	color: rgb(84, 102, 115);
	position: relative;
	top: 5px;
	margin-right: 4px;
}
</style>
<script type="text/javascript">

var getQueryString = function ( field, url ) {
    var href = url ? url : window.location.href;
    var reg = new RegExp( '[?&]' + field + '=([^&#]*)', 'i' );
    var string = reg.exec(href);
    return string ? string[1] : null;
};

var formatDate = function(date) {
	var monthNames = ["January", "February", "March", "April", "May", "June",
  "July", "August", "September", "October", "November", "December"
];
	var hours = date.getHours();
	var minutes = date.getMinutes();
	var ampm = hours >= 12 ? 'pm' : 'am';
	hours = hours % 12;
	hours = hours ? hours : 12; // the hour '0' should be '12'
	minutes = minutes < 10 ? '0'+minutes : minutes;
	var strTime = hours + ':' + minutes + ' ' + ampm;
	return strTime + " - " + date.getDate() + " " + monthNames[date.getMonth()] + " " + date.getFullYear();
	}


var request = new XMLHttpRequest();
request.open('GET', 'https://disqus.com/api/3.0/posts/details.json?api_key=N6iZmlc3bgaZbfYJH5vciV1DrWA0ahSJ8GqVg0brqhqWp0ogsC6m8lfSjGlMVfU5&post=' + getQueryString('id'), true);
request.onload = function() {
	if (request.status >= 200 && request.status < 400) {
		var resp = JSON.parse(request.responseText);
	
		var request2 = new XMLHttpRequest();
		var url = 'https://disqus.com/api/3.0/threads/details.json?api_key=N6iZmlc3bgaZbfYJH5vciV1DrWA0ahSJ8GqVg0brqhqWp0ogsC6m8lfSjGlMVfU5&thread=' + resp.response.thread;
		request2.open('GET', url ,true);
		request2.onload = function() {
			if (request2.status >= 200 && request2.status < 400) {
				var resp2 = JSON.parse(request2.responseText);
			    document.querySelector('.avatar img').src = resp.response.author.avatar.small.permalink;
			    document.querySelector('.name').innerHTML = resp.response.author.name;
			    document.querySelector('.username').innerHTML = resp.response.author.username;
			    document.querySelector('.post').innerHTML = resp.response.message;
			    var d = new Date(resp.response.createdAt);
			    document.querySelector('.date').innerHTML = formatDate(d);
			    document.querySelector('.likes').innerHTML = resp.response.likes;
			    if (resp.response.media[0] && resp.response.media[0].url && getQueryString('media') == 'true'){
			    	document.querySelector('.media_container img').src = resp.response.media[0].url;
			    	document.querySelector('.media_container').style["display"] = 'block';
			    	document.querySelector('.container').style["border-radius"] = '0 0 5px 5px';
			    	document.querySelector('.container').style["border-top"] = 'none';
			    	document.querySelector('.container').style["top"] = '-1px';
			    }
			    document.querySelector('.wrap').onclick = function() {
			    	window.open(resp2.response.link,'_blank');
			    }
			    var links = document.querySelectorAll('a');
			    [].forEach.call(links, function(link) {
			    	link.onclick = function(evt) {
			    		evt.preventDefault();
			    		evt.stopPropagation();
			    		window.open(evt.target.href, '_blank');
			    	}
			    });
			    document.querySelector('.wrap').style["display"] = 'block';
			}
		}
		request2.send();
	}
};
request.send();

var currentHeight = 0;
var i = 0;
function resizeCheck() {
    if(i <= 10) {
    	i++;
		if (document.querySelector('.wrap') && currentHeight != document.querySelector('.wrap').getBoundingClientRect().height) {
			currentHeight = document.querySelector('.wrap').getBoundingClientRect().height;
			parent.postMessage(getQueryString('id') + ':' + currentHeight, '*');
		}
        setTimeout(resizeCheck, 200);
    }
}
resizeCheck();

</script>
</head>
<body>
<div class="wrap">
	<div class="media_container">
	<img src="" width="100%">
	</div>
	<div class="container">
		<div class="logo">
			<img src="https://a.disquscdn.com/dotcom/d-2407bda/img/brand/disqus-social-icon-blue-transparent.png">
		</div>
		<a href="" id="avatar_link">
			<div class="avatar">
				<img src="">
			</div>
			<div class="name">
			</div><br>
			<div class="username">
			</div>
		</a>
		<div class="post">
		</div>
		<div class="date">
		</div>
		<div class="likes">
		<span class="num-likes"></span>
		</div>
	</div>
</div>
</body>
</html>